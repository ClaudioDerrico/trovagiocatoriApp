<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="trovagiocatoriApp.Views.RegisterPage"
             Title="Registrazione"
             BackgroundColor="#FFFFFF">
    <ScrollView>
        <Grid RowSpacing="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header con logo -->
            <Frame Grid.Row="0" BackgroundColor="#333" Padding="12" HasShadow="True" CornerRadius="0">
                <Image Source="trovagiocatori.png" HeightRequest="90" WidthRequest="320" Aspect="AspectFit" HorizontalOptions="Start" />
            </Frame>

            <!-- Contenuto principale -->
            <VerticalStackLayout Grid.Row="1" Spacing="24" Padding="24,32" HorizontalOptions="FillAndExpand" MaximumWidthRequest="460">

                <!-- Intestazione -->
                <VerticalStackLayout Spacing="8" Margin="0,0,0,12">
                    <Label Text="REGISTRAZIONE" FontSize="32" FontAttributes="Bold" TextColor="#333" HorizontalOptions="Start" />
                    <Label Text="Inserisci i tuoi dati per creare un nuovo account" FontSize="16" TextColor="#666" HorizontalOptions="Start" />
                    <Label x:Name="ErrorMessage" Text="" FontSize="14" TextColor="#E53935" IsVisible="False" HorizontalOptions="Start" />
                </VerticalStackLayout>

                <!-- Form -->
                <Frame BorderColor="#E0E0E0" BackgroundColor="#F5F5F5" CornerRadius="12" Padding="20" HasShadow="False">
                    <VerticalStackLayout Spacing="18">
                        <!-- Nome -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Nome" FontAttributes="Bold" TextColor="#333" />
                            <Frame Padding="2" HasShadow="False" BorderColor="#DDDDDD" CornerRadius="8" BackgroundColor="White">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Image Grid.Column="0" Source="id_card.png" HeightRequest="20" WidthRequest="20" Margin="10,0" VerticalOptions="Center" IsVisible="true" />
                                    <Entry Grid.Column="1" x:Name="NomeEntry" Placeholder="Inserisci il tuo nome" BackgroundColor="Transparent" />
                                </Grid>
                            </Frame>
                            <Label x:Name="NomeError" Text="Nome non valido" TextColor="#E53935" FontSize="12" IsVisible="False" Margin="5,0,0,0" />
                        </VerticalStackLayout>

                        <!-- Cognome -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Cognome" FontAttributes="Bold" TextColor="#333" />
                            <Frame Padding="2" HasShadow="False" BorderColor="#DDDDDD" CornerRadius="8" BackgroundColor="White">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Image Grid.Column="0" Source="id_card.png" HeightRequest="20" WidthRequest="20" Margin="10,0" VerticalOptions="Center" IsVisible="true" />
                                    <Entry Grid.Column="1" x:Name="CognomeEntry" Placeholder="Inserisci il tuo cognome" BackgroundColor="Transparent" />
                                </Grid>
                            </Frame>
                            <Label x:Name="CognomeError" Text="Cognome non valido" TextColor="#E53935" FontSize="12" IsVisible="False" Margin="5,0,0,0" />
                        </VerticalStackLayout>

                        <!-- Username -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Username" FontAttributes="Bold" TextColor="#333" />
                            <Frame Padding="2" HasShadow="False" BorderColor="#DDDDDD" CornerRadius="8" BackgroundColor="White">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Image Grid.Column="0" Source="username.png" HeightRequest="20" WidthRequest="20" Margin="10,0" VerticalOptions="Center" IsVisible="true" />
                                    <Entry Grid.Column="1" x:Name="UsernameEntry" Placeholder="Inserisci il tuo username" BackgroundColor="Transparent" />
                                </Grid>
                            </Frame>
                            <Label x:Name="UsernameError" Text="Username non valido" TextColor="#E53935" FontSize="12" IsVisible="False" Margin="5,0,0,0" />
                        </VerticalStackLayout>

                        <!-- Email -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="E-mail" FontAttributes="Bold" TextColor="#333" />
                            <Frame Padding="2" HasShadow="False" BorderColor="#DDDDDD" CornerRadius="8" BackgroundColor="White">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Image Grid.Column="0" Source="email_icon.png" HeightRequest="20" WidthRequest="20" Margin="10,0" VerticalOptions="Center" IsVisible="true" />
                                    <Entry Grid.Column="1" x:Name="EmailEntry" Placeholder="Inserisci la tua email" Keyboard="Email" BackgroundColor="Transparent" />
                                </Grid>
                            </Frame>
                            <Label Text="Ti verrÃ  inviata un'email di conferma (controlla anche negli spam)." FontSize="12" TextColor="#757575" Margin="5,0,0,0" />
                            <Label x:Name="EmailError" Text="E-mail non valida" TextColor="#E53935" FontSize="12" IsVisible="False" Margin="5,0,0,0" />
                        </VerticalStackLayout>

                        <!-- Password -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Password" FontAttributes="Bold" TextColor="#333" />
                            <Frame Padding="2" HasShadow="False" BorderColor="#DDDDDD" CornerRadius="8" BackgroundColor="White">
                                <Grid ColumnDefinitions="Auto,*,Auto">
                                    <Image Grid.Column="0" Source="password_icon.png" HeightRequest="20" WidthRequest="20" Margin="10,0" VerticalOptions="Center" IsVisible="true" />
                                    <Entry Grid.Column="1" x:Name="PasswordEntry" Placeholder="Inserisci la tua password" IsPassword="True" BackgroundColor="Transparent" />
                                    <ImageButton Grid.Column="2" Source="eye_open.png" WidthRequest="24" HeightRequest="24"
                                               Margin="10,0" VerticalOptions="Center" BackgroundColor="Transparent"
                                               Clicked="OnTogglePasswordVisibility" />
                                </Grid>
                            </Frame>
                            <Label x:Name="PasswordError" Text="Inserisci una password di almeno 8 caratteri" TextColor="#E53935" FontSize="12" IsVisible="False" Margin="5,0,0,0" />
                        </VerticalStackLayout>

                        <!-- Foto Profilo -->
                        <VerticalStackLayout Spacing="8" Margin="0,8,0,0">
                            <Label Text="Foto Profilo (facoltativa)" FontAttributes="Bold" TextColor="#333" />
                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                <Button Grid.Column="0" Text="CARICA FOTO" 
                                        Clicked="OnUploadPhotoClicked" 
                                        BackgroundColor="#EEEEEE" 
                                        TextColor="#333333" 
                                        BorderColor="#CCCCCC"
                                        BorderWidth="1"
                                        CornerRadius="8" 
                                        HeightRequest="45" />
                                <Image Grid.Row="1" Grid.ColumnSpan="2" 
                                       x:Name="ProfilePhotoPreview"
                                       HeightRequest="150"
                                       WidthRequest="150"
                                       Aspect="AspectFill"
                                       Margin="0,12,0,0"
                                       HorizontalOptions="Center"
                                       IsVisible="False">
                                    <Image.Clip>
                                        <EllipseGeometry 
                                            Center="75,75"
                                            RadiusX="75"
                                            RadiusY="75" />
                                    </Image.Clip>
                                </Image>
                            </Grid>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- Pulsante Registrazione -->
                <Button Text="REGISTRATI" 
                        BackgroundColor="#1E88E5" 
                        TextColor="White" 
                        CornerRadius="8" 
                        FontAttributes="Bold" 
                        HeightRequest="50" 
                        Clicked="OnRegisterClicked"
                        Margin="0,12,0,24" />
            </VerticalStackLayout>
        </Grid>
    </ScrollView>
</ContentPage>